<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMA Notepad</title>
    
    <!-- PWA এর জন্য প্রয়োজনীয় মেটা ট্যাগ -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="theme-color" content="#36a3ff"/>
    
    <style>
        /* আপনার দেওয়া সব CSS কোড এখানে থাকবে */
        :root{--bg-color:#f0f2f5;--surface-color:rgba(255, 255, 255, 0.9);--text-color:#0d1a26;--subtle-text-color:#5a646d;--primary-color:#007bff;--glow-color:rgba(0, 123, 255, 0.4);--border-color:rgba(0, 0, 0, 0.1);--shadow-color:rgba(0, 0, 0, 0.1)}.dark-theme{--bg-color:#0d1a26;--surface-color:rgba(20, 36, 51, 0.7);--text-color:#e0f2ff;--subtle-text-color:#9cb3c9;--primary-color:#36a3ff;--glow-color:rgba(54, 163, 255, 0.5);--border-color:rgba(255, 255, 255, 0.15);--shadow-color:rgba(0, 0, 0, 0.3)}*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI','Helvetica Neue',Arial,sans-serif}body{background-color:var(--bg-color);color:var(--text-color);transition:background-color .3s ease,color .3s ease}#app-container{max-width:800px;margin:0 auto;padding:20px;padding-top:80px;padding-bottom:100px}header{position:fixed;top:0;left:0;right:0;max-width:800px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:var(--bg-color);z-index:999;border-bottom:1px solid var(--border-color)}header h1{font-size:2.2rem;font-weight:700;color:var(--primary-color);text-shadow:0 0 10px var(--glow-color)}#theme-toggle{background:none;border:none;cursor:pointer;padding:8px;border-radius:50%}#theme-toggle:hover{background-color:var(--border-color)}#theme-toggle svg{width:24px;height:24px;fill:var(--subtle-text-color)}#notes-view,#todos-view{display:none}#notes-view.active,#todos-view.active{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px}#todos-view.active{grid-template-columns:1fr}.note-card{background:var(--surface-color);border:1px solid var(--border-color);border-radius:12px;padding:20px;box-shadow:0 8px 30px var(--shadow-color);backdrop-filter:blur(10px);transition:transform .2s ease,box-shadow .2s ease;display:flex;flex-direction:column;justify-content:space-between;min-height:120px;cursor:pointer}.note-card:hover{transform:translateY(-5px);box-shadow:0 12px 40px var(--shadow-color),0 0 15px var(--glow-color)}.note-preview-text{font-size:1.1rem;font-weight:600;color:var(--primary-color);flex-grow:1;margin-bottom:10px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical}.note-meta{font-size:.8rem;color:var(--subtle-text-color);display:flex;justify-content:space-between;align-items:center}.note-actions{display:flex;gap:10px}.action-btn{background:transparent;border:none;cursor:pointer;padding:5px;opacity:.7;transition:opacity .2s}.action-btn:hover{opacity:1}.action-btn svg{width:18px;height:18px;fill:var(--subtle-text-color)}.todo-item{background:var(--surface-color);border-left:5px solid var(--primary-color);border-radius:8px;padding:15px 20px;box-shadow:0 4px 15px var(--shadow-color);display:flex;flex-direction:column;gap:10px}.todo-item.completed{border-left-color:#28a745;opacity:.7;text-decoration:line-through}.todo-header{display:flex;align-items:center;justify-content:space-between}.todo-title{font-size:1.2rem;font-weight:600}.todo-description{color:var(--subtle-text-color);font-size:.9rem}.todo-time{font-weight:bold;font-size:.9rem;color:var(--primary-color)}.todo-meta{margin-top:15px;font-size:.8rem;color:var(--subtle-text-color);display:flex;justify-content:space-between;align-items:center}#bottom-nav{position:fixed;bottom:0;left:0;right:0;height:70px;background:var(--surface-color);border-top:1px solid var(--border-color);box-shadow:0 -5px 20px var(--shadow-color);backdrop-filter:blur(15px);display:flex;justify-content:space-between;align-items:center;padding:0 20px;z-index:1000}.nav-btn{background:none;border:none;cursor:pointer;padding:10px;border-radius:50%}.nav-btn svg{width:28px;height:28px;fill:var(--subtle-text-color);transition:fill .3s}.nav-btn.active svg{fill:var(--primary-color)}.nav-btn:hover{background-color:var(--border-color)}#add-btn{width:60px;height:60px;border-radius:50%;background:var(--primary-color);border:none;color:white;font-size:36px;font-weight:300;box-shadow:0 4px 15px var(--glow-color);cursor:pointer;position:absolute;left:50%;top:-30px;transform:translateX(-50%)}.modal{position:fixed;top:0;left:0;width:100%;height:100%;background-color:var(--bg-color);display:none;z-index:2000;transition:transform .3s ease-in-out;transform:translateY(100%)}.modal.active{display:block;transform:translateY(0)}.note-editor-content{height:100%;padding:15px;display:flex;flex-direction:column}.note-editor-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;flex-shrink:0}.note-editor-header h2{font-size:1.5rem;color:var(--primary-color);margin:0}#note-title-input,#note-content-input{width:100%;background-color:transparent;border:none;color:var(--text-color)}#note-title-input:focus,#note-content-input:focus{outline:none}#note-title-input{font-size:1.6rem;font-weight:700;padding:10px 5px;flex-shrink:0}#note-content-input{flex-grow:1;resize:none;font-size:1.1rem;line-height:1.7;padding:10px 5px}#todo-modal{transform:none;background:rgba(0,0,0,0.5);display:none}#todo-modal.active{display:flex;align-items:center;justify-content:center}.todo-modal-content{background:var(--surface-color);padding:30px;border-radius:15px;width:90%;max-width:500px;box-shadow:0 10px 40px var(--shadow-color)}.modal-btn{padding:10px 20px;border:none;border-radius:8px;cursor:pointer;font-size:1rem;font-weight:600}.btn-save{background:var(--primary-color);color:white}.btn-cancel{background:transparent;color:var(--primary-color)}.btn-danger{background:transparent;color:#dc3545}
    </style>
</head>
<body>

    <header>
        <h1>MMA Notepad</h1>
        <button id="theme-toggle" aria-label="Toggle Theme">
             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.106a.75.75 0 011.06-1.06l1.591 1.59a.75.75 0 01-1.06 1.06l-1.59-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.894 17.894a.75.75 0 011.06 1.06l-1.59 1.591a.75.75 0 01-1.06-1.06l1.59-1.59zM12 21a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V21.75A.75.75 0 0112 21zM5.106 17.894a.75.75 0 01-1.06 1.06l-1.59-1.591a.75.75 0 111.06-1.06l1.59 1.59zM3 12a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5H3.75A.75.75 0 013 12zM6.106 5.106a.75.75 0 01-1.06-1.06l1.59-1.59a.75.75 0 011.06 1.06l-1.59 1.59z"/></svg>
        </button>
    </header>

    <div id="app-container">
        <main id="content-area">
            <div id="notes-view" class="active"></div>
            <div id="todos-view"></div>
        </main>
    </div>

    <nav id="bottom-nav">
        <button class="nav-btn active" id="nav-notes" aria-label="Notes">
             <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0016.5 9h-1.875a.375.375 0 01-.375-.375V6.75A3.75 3.75 0 0010.5 3H5.625zM12.75 3.75v3h3.75a2.25 2.25 0 012.25 2.25v10.5a.375.375 0 01-.375.375H5.625a.375.375 0 01-.375-.375V3.375c0-.207.168-.375.375-.375H10.5a2.25 2.25 0 012.25 2.25z"/></svg>
        </button>
        <button id="add-btn" aria-label="Add new item">+</button>
        <button class="nav-btn" id="nav-todos" aria-label="To-Do List">
             <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path d="M11.625 1.5a1.125 1.125 0 011.125 1.125v1.875h1.875a1.125 1.125 0 010 2.25h-1.875v1.875a1.125 1.125 0 01-2.25 0V6.75H8.625a1.125 1.125 0 010-2.25h1.875V2.625A1.125 1.125 0 0111.625 1.5zM3.75 3a.75.75 0 00-.75.75v16.5c0 .414.336.75.75.75h16.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75H3.75zM12.75 9a.75.75 0 00-1.5 0v2.25H9a.75.75 0 000 1.5h2.25V15a.75.75 0 001.5 0v-2.25H15a.75.75 0 000-1.5h-2.25V9z"/></svg>
        </button>
    </nav>
    
    <div id="note-modal" class="modal">
        <div class="note-editor-content">
            <div class="note-editor-header">
                <button class="modal-btn btn-cancel" id="cancel-note-btn">Back</button>
                <h2 id="note-modal-title">New Note</h2>
                <div>
                     <button class="modal-btn btn-danger" id="delete-note-btn">Delete</button>
                     <button class="modal-btn btn-save" id="save-note-btn">Save</button>
                </div>
            </div>
            <input type="text" id="note-title-input" placeholder="Title...">
            <textarea id="note-content-input" placeholder="Start writing..."></textarea>
        </div>
    </div>
    
    <div id="todo-modal" class="modal">
        <div class="todo-modal-content">
            <h2>Add New To-Do</h2>
            <input type="text" id="todo-title-input" placeholder="Task?">
            <input type="text" id="todo-desc-input" placeholder="Description (optional)">
            <input type="datetime-local" id="todo-datetime-input">
            <div style="display:flex; justify-content:flex-end; gap:15px; margin-top: 20px;">
                <button class="modal-btn btn-cancel" id="cancel-todo-btn">Cancel</button>
                <button class="modal-btn btn-save" id="save-todo-btn">Save</button>
            </div>
        </div>
    </div>

    <script>
    // --- JavaScript Code Starts Here ---
    document.addEventListener('DOMContentLoaded', () => {
        // All previous JS code remains the same...
        const themeToggle = document.getElementById('theme-toggle');
        const notesView = document.getElementById('notes-view');
        const todosView = document.getElementById('todos-view');
        const navNotes = document.getElementById('nav-notes');
        const navTodos = document.getElementById('nav-todos');
        const addBtn = document.getElementById('add-btn');
        const noteModal=document.getElementById('note-modal');
        const noteModalTitle=document.getElementById('note-modal-title');
        const saveNoteBtn=document.getElementById('save-note-btn');
        const cancelNoteBtn=document.getElementById('cancel-note-btn');
        const deleteNoteBtn=document.getElementById('delete-note-btn');
        const noteTitleInput=document.getElementById('note-title-input');
        const noteContentInput=document.getElementById('note-content-input');
        const todoModal=document.getElementById('todo-modal');
        const saveTodoBtn=document.getElementById('save-todo-btn');
        const cancelTodoBtn=document.getElementById('cancel-todo-btn');
        const todoTitleInput=document.getElementById('todo-title-input');
        const todoDescInput=document.getElementById('todo-desc-input');
        const todoDatetimeInput=document.getElementById('todo-datetime-input');
        let currentView='notes',editingNoteId=null,notes=JSON.parse(localStorage.getItem('notes'))||[],todos=JSON.parse(localStorage.getItem('todos'))||[];
        const applyTheme=e=>document.body.classList.toggle('dark-theme',e==='dark');
        const savedTheme=localStorage.getItem('theme')||'light';
        applyTheme(savedTheme);
        themeToggle.addEventListener('click',()=>{const e=document.body.classList.contains('dark-theme')?'light':'dark';localStorage.setItem('theme',e);applyTheme(e)});
        function switchView(e){currentView=e;notesView.classList.toggle('active',e==='notes');todosView.classList.toggle('active',e==='todos');navNotes.classList.toggle('active',e==='notes');navTodos.classList.toggle('active',e==='todos')}
        navNotes.addEventListener('click',()=>switchView('notes'));
        navTodos.addEventListener('click',()=>switchView('todos'));
        function openNoteModal(e=null){editingNoteId=e;if(e){const t=notes.find(t=>t.id===e);noteModalTitle.textContent="Edit Note";noteTitleInput.value=t.title;noteContentInput.value=t.content;deleteNoteBtn.style.display='inline-block'}else{noteModalTitle.textContent="New Note";noteTitleInput.value='';noteContentInput.value='';deleteNoteBtn.style.display='none'}
        noteModal.classList.add('active')}
        function closeNoteModal(){noteModal.classList.remove('active');editingNoteId=null}
        addBtn.addEventListener('click',()=>currentView==='notes'?openNoteModal():todoModal.classList.add('active'));
        cancelNoteBtn.addEventListener('click',closeNoteModal);
        cancelTodoBtn.addEventListener('click',()=>todoModal.classList.remove('active'));
        function renderNotes(){notesView.innerHTML='';notes.sort((e,t)=>t.id-e.id);if(notes.length===0)return void(notesView.innerHTML='<p style="grid-column: 1 / -1; text-align:center; color: var(--subtle-text-color);">No notes yet. Click \'+\' to add one.</p>');notes.forEach(e=>{const t=e.title||e.content.split('\n')[0]||'Empty Note',o=document.createElement('div');o.classList.add('note-card');o.onclick=()=>openNoteModal(e.id);o.innerHTML=`
                    <p class="note-preview-text">${t.replace(/</g,"<").replace(/>/g,">")}</p>
                    <div class="note-meta">
                        <span>${new Date(e.id).toLocaleDateString()}</span>
                    </div>
                `;notesView.appendChild(o)})}
        saveNoteBtn.addEventListener('click',()=>{const e=noteTitleInput.value.trim(),t=noteContentInput.value.trim();if(!e&&!t)return closeNoteModal();editingNoteId?notes.find(t=>t.id===editingNoteId).title=e:notes.push({id:Date.now(),title:e,content:t});if (editingNoteId) { const noteToUpdate = notes.find(note => note.id === editingNoteId); if(noteToUpdate){noteToUpdate.title = e; noteToUpdate.content = t;} }
        localStorage.setItem('notes',JSON.stringify(notes));renderNotes();closeNoteModal()});
        deleteNoteBtn.addEventListener('click',()=>{if(!editingNoteId)return;confirm("Are you sure you want to permanently delete this note?")&&(notes=notes.filter(e=>e.id!==editingNoteId),localStorage.setItem('notes',JSON.stringify(notes)),renderNotes(),closeNoteModal())});
        function renderTodos(){todosView.innerHTML='';todos.sort((e,t)=>new Date(e.datetime)-new Date(t.datetime));if(todos.length===0)todosView.innerHTML='<p style="grid-column: 1 / -1; text-align:center; color: var(--subtle-text-color);">No tasks yet. Click \'+\' to add one.</p>';else todos.forEach(e=>{const t=document.createElement('div');t.className=`todo-item ${e.completed?'completed':''}`;const o=new Date(e.datetime);t.innerHTML=`
                       <div class="todo-header">
                          <span class="todo-title">${e.title}</span>
                          <div class="note-actions">
                              <button class="action-btn" onclick="toggleTodo(${e.id})" aria-label="Toggle Complete"><svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" /></svg></button>
                              <button class="action-btn" onclick="deleteTodo(${e.id})" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M16.5 4.5a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75zM17.25 8.25a.75.75 0 00-1.5 0v9a.75.75 0 001.5 0v-9zM4.5 6a.75.75 0 01.75-.75h13.5a.75.75 0 010 1.5H5.25a.75.75 0 01-.75-.75zM8.25 8.25a.75.75 0 00-1.5 0v9a.75.75 0 001.5 0v-9zM12 8.25a.75.75 0 00-1.5 0v9a.75.75 0 001.5 0v-9z" clip-rule="evenodd" /></svg></button>
                          </div>
                       </div>
                       ${e.description?`<p class="todo-description">${e.description}</p>`:''}
                       <div class="todo-meta">
                          <span class="todo-time">Due: ${o.toLocaleString()}</span>
                       </div>`;todosView.appendChild(t)})}
        saveTodoBtn.addEventListener('click',()=>{const e=todoTitleInput.value.trim(),t=todoDatetimeInput.value;if(!e||!t)return alert('Task title and time are required!');todos.push({id:Date.now(),title:e,datetime:t,description:todoDescInput.value.trim(),completed:!1,notified:!1,lastNotified:null});localStorage.setItem('todos',JSON.stringify(todos));renderTodos();todoModal.classList.remove('active');todoTitleInput.value='';todoDescInput.value='';todoDatetimeInput.value=''});
        window.deleteTodo=e=>{todos=todos.filter(t=>t.id!==e);localStorage.setItem('todos',JSON.stringify(todos));renderTodos()};
        window.toggleTodo=e=>{const t=todos.find(t=>t.id===e);t&&(t.completed=!t.completed,localStorage.setItem('todos',JSON.stringify(todos)),renderTodos())};
        Notification.permission!=='granted'&&Notification.requestPermission();
        function checkTodosForNotification(){const e=new Date;todos.forEach(t=>{const o=new Date(t.datetime),i=3e5;if(!t.completed&&e>=o){const n=t.lastNotified?new Date(t.lastNotified):null;(!n||e-n>=i)&&(new Notification(`Task: ${t.title}`,{body:t.description||'Time for your task!'}),t.lastNotified=e.toISOString(),localStorage.setItem('todos',JSON.stringify(todos)))}})}
        function init(){renderNotes();renderTodos();setInterval(checkTodosForNotification,3e4);switchView(currentView)}init();

        // নতুন কোড: Service Worker রেজিস্টার করা
        if ('serviceWorker' in navigator) {
          window.addEventListener('load', () => {
            navigator.serviceWorker.register('service-worker.js')
              .then(registration => {
                console.log('ServiceWorker registration successful:', registration);
              })
              .catch(err => {
                console.log('ServiceWorker registration failed:', err);
              });
          });
        }
    });
    </script>
</body>
</html>